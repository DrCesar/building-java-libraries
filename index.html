<!doctype html>
<html lang="en">
 <head> 
  <meta charset="utf-8"> 
  <!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]--> 
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
  <meta name="generator" content="Asciidoctor 1.5.3"> 
  <title>Building Java Libraries</title> 
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css"> 
  <link rel="stylesheet" href="./coderay-asciidoctor.css"> 
  <link rel="stylesheet" href="https://guides.gradle.org/asciidoctor.css"> 
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,400,700|Source+Code+Pro:500"> 
  <link rel="apple-touch-icon" sizes="180x180" href="https://guides.gradle.org/icon/apple-touch-icon.png"> 
  <link rel="icon" type="image/png" href="https://guides.gradle.org/icon/favicon-32x32.png" sizes="32x32"> 
  <link rel="icon" type="image/png" href="https://guides.gradle.org/icon/favicon-16x16.png" sizes="16x16"> 
  <link rel="manifest" href="https://guides.gradle.org/icon/manifest.json"> 
  <link rel="mask-icon" href="https://guides.gradle.org/icon/safari-pinned-tab.svg" color="#5bbad5"> 
  <link rel="shortcut icon" href="https://guides.gradle.org/icon/favicon.ico"> 
  <meta name="apple-mobile-web-app-title" content="Building JVM Libraries"> 
  <meta name="application-name" content="Building JVM Libraries"> 
  <meta name="msapplication-config" content="https://guides.gradle.org/icon/browserconfig.xml"> 
  <meta name="theme-color" content="#ffffff"> 
  <script>
  (function(i,s,o,g,r,a,m){i["GoogleAnalyticsObject"]=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,"script","https://www.google-analytics.com/analytics.js","ga");
  ga("create", "UA-4207603-1", "auto");
  ga("send", "pageview");
</script> 
 </head> 
 <body class="article toc2 toc-right"> 
  <div id="header">
   <div style="padding-top: 10px;">
    <a href="https://guides.gradle.org"><img src="http://guides.gradle.org/gradle-guides.svg" alt=""></a>
   </div> 
   <h1>Building Java Libraries <span class="image"><a class="image" href="https://travis-ci.org/gradle-guides/building-java-libraries"><img src="https://travis-ci.org/gradle-guides/building-java-libraries.svg?branch=master" alt="Build Status"></a></span></h1> 
   <div id="toc" class="toc2"> 
    <div id="toctitle">
     Table of Contents
    </div> 
    <ul class="sectlevel1"> 
     <li><a href="#what_you_ll_build">What you’ll build</a></li> 
     <li><a href="#what_you_ll_need">What you’ll need</a></li> 
     <li><a href="#create_a_library_project">Create a library project</a></li> 
     <li><a href="#assemble_the_library_jar">Assemble the library JAR</a></li> 
     <li><a href="#customize_the_library_jar">Customize the library JAR</a></li> 
     <li><a href="#consume_the_library_jar">Consume the library JAR</a></li> 
     <li><a href="#summary">Summary</a></li> 
     <li><a href="#next_steps">Next steps</a></li> 
    </ul> 
   </div> 
  </div> 
  <div id="content"> 
   <div id="preamble"> 
    <div class="sectionbody"> 
     <div class="paragraph"> 
      <p>This guide walks you through the process of using Gradle to produce a JVM library suitable for consumption by other JVM libraries and applications.</p> 
     </div> 
    </div> 
   </div> 
   <div class="sect1"> 
    <h2 id="what_you_ll_build"><a class="anchor" href="#what_you_ll_build"></a>What you’ll build</h2> 
    <div class="sectionbody"> 
     <div class="paragraph"> 
      <p>You’ll start by creating a Java library project consisting of a single class. You’ll then use Gradle to compile and package the library into a <em>Java Archive</em> (<a href="https://docs.oracle.com/javase/8/docs/technotes/guides/jar/index.html">JAR</a>) that contains the compiled class and a default manifest file. Next, you’ll configure your Gradle build script to customize the name of the JAR and the contents of its manifest. Finally, you’ll verify that the library JAR is well-formed by consuming it from a separate command-line application.</p> 
     </div> 
    </div> 
   </div> 
   <div class="sect1"> 
    <h2 id="what_you_ll_need"><a class="anchor" href="#what_you_ll_need"></a>What you’ll need</h2> 
    <div class="sectionbody"> 
     <div class="ulist"> 
      <ul> 
       <li> <p>About 10 minutes</p> </li> 
       <li> <p>A text editor or IDE</p> </li> 
       <li> <p>A <a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">Java Development Kit</a> (JDK), version 1.7 or better</p> </li> 
       <li> <p>A <a href="https://docs.gradle.org/3.3/userguide//installation.html#sec:download">Gradle distribution</a>, version 3.3 or better</p> </li> 
      </ul> 
     </div> 
    </div> 
   </div> 
   <div class="sect1"> 
    <h2 id="create_a_library_project"><a class="anchor" href="#create_a_library_project"></a>Create a library project</h2> 
    <div class="sectionbody"> 
     <div class="paragraph"> 
      <p>Create a new project directory named <code>mylib</code> and initialize the directory structure that will contain your library’s sources, for example by running the following commands on a Unix-like system:</p> 
     </div> 
     <div class="listingblock"> 
      <div class="content"> 
       <pre class="CodeRay highlight"><code data-lang="shell">$ mkdir mylib
$ cd mylib
$ mkdir -p src/main/java/org/example/mylib</code></pre> 
      </div> 
     </div> 
     <div class="paragraph"> 
      <p>Now create a class named <code>Greeter</code> as follows:</p> 
     </div> 
     <div class="listingblock"> 
      <div class="title">
       src/main/java/org/example/mylib/Greeter.java
      </div> 
      <div class="content"> 
       <pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">org.example.mylib</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">Greeter</span> {
    <span class="directive">private</span> <span class="predefined-type">String</span> name;

    <span class="directive">public</span> Greeter(<span class="predefined-type">String</span> name) { <span class="local-variable">this</span>.name = name; }

    <span class="directive">public</span> <span class="predefined-type">String</span> getGreeting() { <span class="keyword">return</span> <span class="string"><span class="delimiter">"</span><span class="content">Hello, </span><span class="delimiter">"</span></span> + <span class="local-variable">this</span>.name + <span class="string"><span class="delimiter">"</span><span class="content">!</span><span class="delimiter">"</span></span>; }
}</code></pre> 
      </div> 
     </div> 
     <div class="paragraph"> 
      <p>You now have the necessary components for a simple Java library project. The next step is to create a Gradle build script capable of compiling and packaging the library into a JAR. To do so, add a file named <code>build.gradle</code> in the root of the project and apply Gradle’s <a href="https://docs.gradle.org/3.3/userguide/java_plugin.html">Java plugin</a> as follows:</p> 
     </div> 
     <div class="listingblock"> 
      <div class="title">
       build.gradle
      </div> 
      <div class="content"> 
       <pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">java</span><span class="delimiter">'</span></span></code></pre> 
      </div> 
     </div> 
     <div class="paragraph"> 
      <p>Once you’ve saved the file, you’re ready to assemble your library JAR.</p> 
     </div> 
    </div> 
   </div> 
   <div class="sect1"> 
    <h2 id="assemble_the_library_jar"><a class="anchor" href="#assemble_the_library_jar"></a>Assemble the library JAR</h2> 
    <div class="sectionbody"> 
     <div class="paragraph"> 
      <p>The Java plugin <a href="https://docs.gradle.org/3.3/userguide/java_plugin.html#sec:java_tasks">adds a number of tasks</a> to your project, including a <code>jar</code> task. To assemble your library JAR, run <code>gradle jar</code>, like so:</p> 
     </div> 
     <div class="listingblock"> 
      <div class="content"> 
       <pre>$ gradle jar
:compileJava
:processResources UP-TO-DATE
:classes
:jar

BUILD SUCCESSFUL</pre> 
      </div> 
     </div> 
     <div class="paragraph"> 
      <p>The output above tells you that running the <code>jar</code> task causes Gradle to:</p> 
     </div> 
     <div class="olist arabic"> 
      <ol class="arabic"> 
       <li> <p>compile the Java source code</p> </li> 
       <li> <p>process any resource files</p> </li> 
       <li> <p>package everything up into a JAR file</p> </li> 
      </ol> 
     </div> 
     <div class="admonitionblock note"> 
      <table> 
       <tbody>
        <tr> 
         <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> 
         <td class="content"> 
          <div class="paragraph"> 
           <p>All of this happens without any additional configuration in <code>build.gradle</code> because Gradle’s Java plugin assumes your project sources are arranged in a <a href="https://docs.gradle.org/3.3/userguide/java_plugin.html#sec:java_project_layout">conventional project layout</a>. You can customize the project layout if you wish <a href="https://docs.gradle.org/3.3/userguide/java_plugin.html#sec:changing_java_project_layout">as described in the user manual</a>.</p> 
          </div> </td> 
        </tr> 
       </tbody>
      </table> 
     </div> 
     <div class="paragraph"> 
      <p>You can find your newly packaged JAR file in the <code>build/libs</code> directory with the name <code>mylib.jar</code>. Verify that the archive is valid by running the following command:</p> 
     </div> 
     <div class="listingblock"> 
      <div class="content"> 
       <pre>$ jar tf build/libs/mylib.jar
META-INF/
META-INF/MANIFEST.MF
org/
org/example/
org/example/Greeter.class</pre> 
      </div> 
     </div> 
     <div class="paragraph"> 
      <p>You should see the required manifest file—<code>MANIFEST.MF</code>—and the compiled <code>Greeter</code> class.</p> 
     </div> 
     <div class="paragraph"> 
      <p>At this point, your library is ready to be consumed by other JVM-based projects, but there are a couple of customizations you may want to make first. We’ll look at those next.</p> 
     </div> 
    </div> 
   </div> 
   <div class="sect1"> 
    <h2 id="customize_the_library_jar"><a class="anchor" href="#customize_the_library_jar"></a>Customize the library JAR</h2> 
    <div class="sectionbody"> 
     <div class="paragraph"> 
      <p>You will often want the name of the JAR file to include the library <em>version</em>. This is easily achieved by setting a top-level <code>version</code> property in the build script, like so:</p> 
     </div> 
     <div class="listingblock"> 
      <div class="title">
       build.gradle
      </div> 
      <div class="content"> 
       <pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">java</span><span class="delimiter">'</span></span>

version = <span class="string"><span class="delimiter">'</span><span class="content">0.1.0</span><span class="delimiter">'</span></span></code></pre> 
      </div> 
     </div> 
     <div class="paragraph"> 
      <p>Now run the <code>jar</code> task once more:</p> 
     </div> 
     <div class="listingblock"> 
      <div class="content"> 
       <pre>$ gradle jar</pre> 
      </div> 
     </div> 
     <div class="paragraph"> 
      <p>and notice that the resulting JAR file at <code>build/libs/mylib-0.1.0.jar</code> contains the version as expected.</p> 
     </div> 
     <div class="paragraph"> 
      <p>Another common requirement is customizing the manifest file, typically by adding one or more attributes. Let’s include the library name and version in the manifest file by <a href="https://docs.gradle.org/3.3/userguide/more_about_tasks.html#sec:configuring_tasks">configuring the <code>jar</code> task</a>. Add the following to the end of your build script:</p> 
     </div> 
     <div class="listingblock"> 
      <div class="title">
       build.gradle
      </div> 
      <div class="content"> 
       <pre class="CodeRay highlight"><code data-lang="groovy">jar {
    manifest {
        attributes(<span class="string"><span class="delimiter">'</span><span class="content">Implementation-Title</span><span class="delimiter">'</span></span>: project.name,
                   <span class="string"><span class="delimiter">'</span><span class="content">Implementation-Version</span><span class="delimiter">'</span></span>: project.version)
    }
}</code></pre> 
      </div> 
     </div> 
     <div class="paragraph"> 
      <p>To confirm that these changes work as expected, run the <code>jar</code> task again, and this time also unpack the manifest file from the JAR:</p> 
     </div> 
     <div class="listingblock"> 
      <div class="content"> 
       <pre>$ gradle jar
$ jar xf build/libs/mylib-0.1.0.jar META-INF/MANIFEST.MF</pre> 
      </div> 
     </div> 
     <div class="paragraph"> 
      <p>Now view the contents of the <code>META-INF/MANIFEST.MF</code> file and you should see the following:</p> 
     </div> 
     <div class="listingblock"> 
      <div class="title">
       META-INF/MANIFEST.MF
      </div> 
      <div class="content"> 
       <pre class="CodeRay highlight"><code data-lang="mf">Manifest-Version: 1.0
Implementation-Title: mylib
Implementation-Version: 0.1.0</code></pre> 
      </div> 
     </div> 
     <div class="admonitionblock note"> 
      <table> 
       <tbody>
        <tr> 
         <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> 
         <td class="content"> 
          <div class="title">
           Learn more about configuring JARs
          </div> 
          <div class="paragraph"> 
           <p>The <code>manifest</code> is just one of many properties that can be configured on the <code>jar</code> task. For a complete list, see the <a href="https://docs.gradle.org/3.3/dsl/org.gradle.api.tasks.bundling.Jar.html">Jar section</a> of the <a href="https://docs.gradle.org/3.3/dsl/">Gradle Language Reference</a> as well as the <a href="https://docs.gradle.org/3.3/userguide/java_plugin.html#sec:jar">Jar</a> and <a href="https://docs.gradle.org/3.3/userguide/working_with_files.html#sec:archives">Creating Archives</a> sections of the Gradle <a href="https://docs.gradle.org/3.3/userguide/">User Manual</a>.</p> 
          </div> </td> 
        </tr> 
       </tbody>
      </table> 
     </div> 
     <div class="paragraph"> 
      <p>Now you can complete this exercise by trying to compile some Java code that uses the library you just built.</p> 
     </div> 
    </div> 
   </div> 
   <div class="sect1"> 
    <h2 id="consume_the_library_jar"><a class="anchor" href="#consume_the_library_jar"></a>Consume the library JAR</h2> 
    <div class="sectionbody"> 
     <div class="paragraph"> 
      <p>Create a new Java file in the root of the project called <code>Main.java</code> and put the following code in it:</p> 
     </div> 
     <div class="listingblock"> 
      <div class="title">
       Main.java
      </div> 
      <div class="content"> 
       <pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.example.mylib.Greeter</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">Main</span> {
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span>... args) {
        <span class="predefined-type">System</span>.out.println(<span class="keyword">new</span> Greeter(<span class="string"><span class="delimiter">"</span><span class="content">Gradle</span><span class="delimiter">"</span></span>).getGreeting());
    }
}</code></pre> 
      </div> 
     </div> 
     <div class="paragraph"> 
      <p>If you now try to compile this file, you’ll get the following error:</p> 
     </div> 
     <div class="listingblock"> 
      <div class="content"> 
       <pre>$ javac Main.java
Main.java:1: error: package org.example.mylib does not exist
import org.example.mylib.Greeter;
                        ^
Main.java:5: error: cannot find symbol
        System.out.println(new Greeter("Gradle").getGreeting());
                               ^
  symbol:   class Greeter
  location: class Main
2 errors</pre> 
      </div> 
     </div> 
     <div class="paragraph"> 
      <p>Let’s fix that quickly by including our JAR file on the compilation classpath:</p> 
     </div> 
     <div class="listingblock"> 
      <div class="content"> 
       <pre>$ javac -cp .:build/libs/mylib-0.1.0.jar Main.java</pre> 
      </div> 
     </div> 
     <div class="paragraph"> 
      <p>Finally, run the application to test everything is working:</p> 
     </div> 
     <div class="listingblock"> 
      <div class="content"> 
       <pre>$ java -cp .:build/libs/mylib-0.1.0.jar Main
Hello, Gradle!</pre> 
      </div> 
     </div> 
    </div> 
   </div> 
   <div class="sect1"> 
    <h2 id="summary"><a class="anchor" href="#summary"></a>Summary</h2> 
    <div class="sectionbody"> 
     <div class="paragraph"> 
      <p>That’s it! You’ve now successfully built a Java library project, packaged it as a JAR and consumed it within a separate application. Along the way, you’ve learned how to:</p> 
     </div> 
     <div class="ulist"> 
      <ul> 
       <li> <p>Apply Gradle’s Java plugin</p> </li> 
       <li> <p>Run the Java plugin’s <code>jar</code> task and examine its output</p> </li> 
       <li> <p>Customize the name of a JAR file and the content of its manifest</p> </li> 
      </ul> 
     </div> 
    </div> 
   </div> 
   <div class="sect1"> 
    <h2 id="next_steps"><a class="anchor" href="#next_steps"></a>Next steps</h2> 
    <div class="sectionbody"> 
     <div class="paragraph"> 
      <p>Building a library is just one aspect of reusing code across project boundaries. From here, you may be interested in:</p> 
     </div> 
     <div class="ulist"> 
      <ul> 
       <li> <p><a href="https://docs.gradle.org/3.3/userguide/artifact_dependencies_tutorial.html">Consuming JVM libraries</a></p> </li> 
       <li> <p><a href="https://docs.gradle.org/3.3/userguide/artifact_management.html">Publishing JVM libraries</a></p> </li> 
       <li> <p><a href="https://docs.gradle.org/3.3/userguide/intro_multi_project_builds.html">Working with multi-project builds</a></p> </li> 
      </ul> 
     </div> 
    </div> 
   </div> 
  </div> 
  <div id="footer"> 
   <div id="footer-text">
     Last updated 2017-04-04 10:01:12 UTC 
   </div> 
  </div>  
 </body>
</html>